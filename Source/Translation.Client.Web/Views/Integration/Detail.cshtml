@model IntegrationDetailModel

<label data-translation="integration_name">integration_name</label>
<h1>@Model.Name</h1>

<div>
    <label data-translation="description">description</label>
    @Model.Description
</div>

<div>
    <label data-translation="organization">organization</label>
    <a href="/Organization/Detail/@Model.OrganizationUid">@Model.OrganizationName</a>
</div>

<div class="bottom-links">
    <a href="/Integration/Edit/@Model.IntegrationUid" data-translation="edit_link">edit_link</a>
    <a href="/Integration/ActiveTokens/@Model.IntegrationUid" data-translation="active_tokens_link">active_tokens_link</a>
    <a href="/Integration/Revisions/@Model.IntegrationUid" data-translation="revisions_link">revisions_link</a>
    <button type="button" class="btnRed"
            data-confirm-title="delete_integration_confirm_title"
            data-confirm-content="delete_integration_confirm_content"
            data-url="/Integration/Delete/"
            data-prm="id=@Model.IntegrationUid"
            onclick="doRedirectIfConfirmedSuccess(this, '/Organization/Detail/@Model.OrganizationUid')"
            data-translation="delete_button">
        delete_button
    </button>
</div>

<h2 data-translation="integration_clients">integration_clients</h2>
<div class="tbl">
    <button type="button" style="margin-top: 5px;"
            data-translation="create_integration_client_link"
            data-confirm-title="create_integration_client_confirm_title"
            data-confirm-content="create_integration_client_confirm_content"
            data-url="/Integration/ClientCreate/"
            data-prm="id=@Model.IntegrationUid"
            onclick="handlePostAndAppendRow(this)">
        create_integration_client_link
    </button>
    <table data-result="/Integration/ClientListData/@Model.IntegrationUid"></table>
</div>

@section Scripts {
<script>
    function showHiddenText(id) {
        var td = document.querySelector("td[data-id='" + id + "']");
        var text = td.getAttribute('hidden-text');
        td.innerHTML = text + " <a href='javascript:hideHiddenText(\""+id+"\")'>hide</a>";
    }
    
    function hideHiddenText(id) {
        var td = document.querySelector("td[data-id='" + id + "']");
        var text = td.getAttribute('hidden-text');
        td.innerHTML = "<span style='float:left;margin-top:4px;'>"+ ("*".repeat(text.length)) + "</span> <a href='javascript:showHiddenText(\""+id+"\")'>show</a>";
    }

    var tableChangeInterval = setInterval(() => {
        var table = document.getElementsByTagName('table')[0];
        var rows = table.querySelectorAll('tr');

        if (rows.length > 0) {
            clearInterval(tableChangeInterval);
            rows = table.querySelectorAll('tbody tr');

            rows.forEach((row) => {
                var uid = row.getAttribute('data-uid');
                var columnCounter = -1;
                var columns = row.querySelectorAll("td");
                columns.forEach((column) => {
                    columnCounter++;
                    if (columnCounter === 1 || columnCounter === 0) {
                        var text = column.innerText;
                        column.setAttribute('hidden-text', text);
                        column.setAttribute('data-id', uid + "-" + columnCounter);
                        column.innerHTML = "<span style='float:left;margin-top:4px;'>"+ ("*".repeat(text.length)) + "</span> <a href='javascript:showHiddenText(\""+uid+"-"+columnCounter+"\")'>show</a>";
                    }
                });
            });
        }
    }, 5);
</script>
}
